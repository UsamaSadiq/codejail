#include <tunables/global>

profile custom-apparmor {
#include <abstractions/base>
#include <abstractions/python>

# Whitelist particular shared objects from the system
# python installation
#
/usr/lib/python/lib-dynload/_json.so mr,
/usr/lib/python/lib-dynload/_ctypes.so mr,
/usr/lib/python/lib-dynload/_heapq.so mr,
/usr/lib/python/lib-dynload/_io.so mr,
/usr/lib/python/lib-dynload/_csv.so mr,
/usr/lib/python/lib-dynload/datetime.so mr,
/usr/lib/python/lib-dynload/_elementtree.so mr,
/usr/lib/python/lib-dynload/pyexpat.so mr,
/usr/lib/python/lib-dynload/future_builtins.so mr,
#
# Allow access to selections from /proc
#
/proc/*/mounts r,
}